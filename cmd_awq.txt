wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
bash ./Miniconda3-latest-Linux-x86_64.sh -b -p /scratch/qh2262/miniconda3

cd /scratch/qh2262

singularity shell --nv -B /scratch:/scratch \
  /scratch/work/public/singularity/cuda12.2.2-cudnn8.9.4-devel-ubuntu22.04.3.sif

source /scratch/qh2262/miniconda3/etc/profile.d/conda.sh
export PATH=/scratch/qh2262/miniconda3/bin:$PATH

conda create -n llava python=3.10 -y
conda activate llava
source /scratch/qh2262/miniconda3/etc/profile.d/conda.sh
export PATH=/scratch/qh2262/miniconda3/envs/llava/bin:$PATH

which nvcc
nvcc --version

pip install -q transformers accelerate pillow torch
pip install -q flash-attn --no-build-isolation

pip install llmcompressor datasets

pip install -U bitsandbytes


#非官方无可用多模态
pip install vllm

#如需多模态
git clone https://github.com/vllm-project/vllm.git
cd vllm
pip install -e .
#加速版
CCACHE_NOHASHDIR="true" pip install --no-build-isolation -e .

uv pip install -r requirements/build.txt
uv pip install --no-build-isolation -e .










